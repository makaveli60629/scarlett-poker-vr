<!-- /index.html — ScarlettVR Prime 10.0 (FULL) v10.0.1
✅ Loads /js/boot.js
✅ Full Diagnostics HUD (copy log, hide/show, status)
✅ VRButton support + Manual Enter VR button
✅ Mobile-safe HUD + UNSTUCK + SPAWN + Room buttons
✅ Works with your boot.js + index.js + world.js architecture
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="theme-color" content="#05070d" />
  <title>ScarlettVR Poker</title>

  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden;
      background: #05070d;
      color: #e9f2ff;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      touch-action: none;
    }

    #app { position: fixed; inset: 0; }

    /* HUD container */
    #hud {
      position: fixed;
      left: 10px;
      top: 10px;
      width: min(560px, calc(100vw - 20px));
      max-height: min(70vh, 520px);
      display: block;
      z-index: 9999;
      pointer-events: auto;
      user-select: none;
      background: rgba(0,0,0,0.35);
      border: 1px solid rgba(102,204,255,0.35);
      border-radius: 14px;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.35);
    }

    #hudHeader {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 10px 10px 8px 10px;
      border-bottom: 1px solid rgba(102,204,255,0.22);
      background: rgba(8,10,16,0.35);
    }

    #hudTitle {
      font-weight: 800;
      letter-spacing: 0.2px;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    #hudStatus {
      font-size: 12px;
      opacity: 0.95;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,211,107,0.35);
      background: rgba(255,211,107,0.12);
      color: #ffe7b0;
      white-space: nowrap;
    }

    #hudBtns {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    button {
      appearance: none;
      border: 1px solid rgba(102,204,255,0.35);
      background: rgba(0,0,0,0.25);
      color: #e9f2ff;
      border-radius: 10px;
      padding: 8px 10px;
      font-weight: 750;
      font-size: 12px;
      cursor: pointer;
      line-height: 1;
      box-shadow: 0 0 0 rgba(0,0,0,0);
      transition: transform 0.06s ease, background 0.12s ease;
    }
    button:active { transform: scale(0.98); }
    button.primary {
      border-color: rgba(255,211,107,0.45);
      background: rgba(255,211,107,0.12);
      color: #ffe7b0;
    }
    button.danger {
      border-color: rgba(255,107,214,0.45);
      background: rgba(255,107,214,0.10);
      color: #ffd6f0;
    }

    #hudBody {
      padding: 10px;
      display: grid;
      gap: 8px;
    }

    #rowA, #rowB {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    #hudLogWrap {
      border: 1px solid rgba(102,204,255,0.22);
      border-radius: 12px;
      overflow: hidden;
      background: rgba(0,0,0,0.18);
    }

    #hud-log {
      margin: 0;
      padding: 10px;
      max-height: 40vh;
      overflow: auto;
      font-size: 11px;
      line-height: 1.25;
      white-space: pre-wrap;
      word-break: break-word;
      color: rgba(233,242,255,0.92);
    }

    /* Compact footer bar */
    #hudFooter {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      padding: 8px 10px;
      border-top: 1px solid rgba(102,204,255,0.22);
      background: rgba(8,10,16,0.35);
      font-size: 12px;
      opacity: 0.95;
    }

    #mini {
      position: fixed;
      right: 10px;
      top: 10px;
      z-index: 9999;
      display: none;
      pointer-events: auto;
    }

    /* Small screens: move HUD lower so it doesn't block view */
    @media (max-width: 520px) {
      #hud { top: auto; bottom: 10px; left: 10px; }
      #hud-log { max-height: 26vh; }
    }
  </style>
</head>

<body>
  <div id="app"></div>

  <!-- Full Diagnostics HUD -->
  <div id="hud">
    <div id="hudHeader">
      <div id="hudTitle">
        <span>ScarlettVR Diagnostics</span>
        <span id="hudStatus">booting…</span>
      </div>
      <div id="hudBtns">
        <button id="btnHud" class="primary" title="Hide/Show HUD">HUD</button>
        <button id="btnCopy" title="Copy the log">COPY</button>
        <button id="enterVrBtn" class="primary" title="Manual Enter VR">ENTER VR</button>
        <button id="btnUnstuck" class="danger" title="Teleport to safe pad">UNSTUCK</button>
      </div>
    </div>

    <div id="hudBody">
      <div id="rowA">
        <button id="btnSpawn" class="primary">SPAWN</button>
        <button id="btnLobby">LOBBY</button>
        <button id="btnPoker">POKER</button>
        <button id="btnStore">STORE</button>
        <button id="btnScorpion">SCORPION</button>
        <button id="btnSpectate">SPECTATE</button>
      </div>

      <div id="rowB">
        <button id="btnNewHand" class="primary">NEW HAND</button>
        <button id="btnHealthcheck">HEALTHCHECK</button>
      </div>

      <div id="hudLogWrap">
        <pre id="hud-log">Loading…</pre>
      </div>
    </div>

    <div id="hudFooter">
      <div id="hudRoom">room: ?</div>
      <div id="hudPos">pos: ?</div>
      <div id="hudXR">XR: ?</div>
    </div>
  </div>

  <!-- Minimal HUD toggle when full HUD is hidden -->
  <div id="mini">
    <button id="btnHudMini" class="primary">HUD</button>
  </div>
  <script src="./js/boot.js?v=777"></script>

  <script>
    // ---------- HTML ↔ Boot/Index hooks ----------
    (function () {
      const logEl = document.getElementById("hud-log");
      const statusEl = document.getElementById("hudStatus");
      const hud = document.getElementById("hud");
      const mini = document.getElementById("mini");

      const hudRoom = document.getElementById("hudRoom");
      const hudPos  = document.getElementById("hudPos");
      const hudXR   = document.getElementById("hudXR");

      const buf = [];
      function push(line) {
        buf.push(line);
        if (buf.length > 200) buf.shift();
        if (logEl) logEl.textContent = buf.join("\n");
      }

      // Boot.js calls these if present
      window.__HTML_LOG = (line) => push(line);
      window.__SET_BOOT_STATUS = (t) => { if (statusEl) statusEl.textContent = String(t || ""); };

      // World/DebugHUD can use these if desired
      window.__HUD_SET = (k, v) => {
        if (k === "room" && hudRoom) hudRoom.textContent = "room: " + String(v ?? "?");
        if (k === "pos"  && hudPos)  hudPos.textContent  = "pos: " + String(v ?? "?");
        if (k === "xr"   && hudXR)   hudXR.textContent   = String(v ?? "XR: ?");
      };

      // Buttons
      const btnCopy = document.getElementById("btnCopy");
      btnCopy?.addEventListener("click", async () => {
        try {
          const text = (logEl?.textContent || "").trim();
          await navigator.clipboard.writeText(text);
          push("[hud] copied ✅");
        } catch (e) {
          push("[hud] copy failed ⚠️ " + (e?.message || String(e)));
        }
      });

      function setHudVisible(on) {
        if (!hud || !mini) return;
        hud.style.display = on ? "block" : "none";
        mini.style.display = on ? "none" : "block";
      }

      const btnHud = document.getElementById("btnHud");
      const btnHudMini = document.getElementById("btnHudMini");

      btnHud?.addEventListener("click", () => setHudVisible(hud.style.display === "none"));
      btnHudMini?.addEventListener("click", () => setHudVisible(true));

      // Start with HUD visible
      setHudVisible(true);

      // Helpful initial lines
      push("[HTML] loaded ✅ (waiting for /js/boot.js…)");

      // In case something overwrote console, still show basic info
      push(`[HTML] href=${location.href}`);
      push(`[HTML] secureContext=${String(window.isSecureContext)}`);
      push(`[HTML] ua=${navigator.userAgent}`);
    })();
  </script>

  <!-- Boot Loader (your boot.js handles base path + dynamic import of /js/index.js) -->
  <script type="module" src="./js/boot.js"></script>
</body>
</html>
