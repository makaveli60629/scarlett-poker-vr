<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>SCARLETTVR Demo v10 FIX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <style>
    html, body { margin:0; padding:0; width:100%; height:100%; background:#000; overflow:hidden; }
    a-scene { width:100%; height:100%; }
    #hud {
      position: fixed; left: 12px; right: 12px; top: 12px; z-index: 9999;
      color: #dff; font: 13px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: rgba(0,0,0,0.60); border: 1px solid rgba(120,200,220,0.25);
      border-radius: 14px; padding: 10px 12px;
      backdrop-filter: blur(6px);
    }
    #hud .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    #hud button {
      background:#14202b; color:#e8f7ff; border:1px solid rgba(120,200,220,0.25);
      border-radius: 12px; padding: 10px 12px; font-weight: 650; letter-spacing: 0.2px;
    }
    #hud button:active { transform: scale(0.98); }
    #log {
      margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(120,200,220,0.15);
      white-space: pre-wrap; word-break: break-word; max-height: 30vh; overflow:auto;
      color: #bfefff;
    }
  </style>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>
<body>
  <div id="hud">
    <div class="row">
      <button id="btnEnter">ENTER VR</button>
      <button id="btnDiag">DIAG</button>
      <button id="btnReset">RESET</button>
      <span id="status" style="opacity:.9">booting…</span>
    </div>
    <div id="log">Loading engine…</div>
  </div>

  <a-scene id="scene"
    embedded
    renderer="antialias: true; colorManagement: true"
    xr-mode-ui="enabled: false"
    webxr="requiredFeatures: local-floor; optionalFeatures: bounded-floor, hand-tracking"
    background="color: #081018">

    <!-- Camera Rig -->
    <a-entity id="rig" position="0 0 4">
      <a-entity id="cam" camera position="0 1.65 0" look-controls="pointerLockEnabled: false"></a-entity>

      <!-- Mobile / Desktop cursor so we NEVER go black from missing controllers -->
      <a-entity id="cursor"
        cursor="rayOrigin: mouse; fuse: false"
        raycaster="objects: .clickable, .teleportable; far: 30">
      </a-entity>

      <!-- Quest controllers (created but safe if missing) -->
      <a-entity id="leftHand" laser-controls="hand: left"
        raycaster="objects: .clickable, .teleportable; far: 30"
        line="opacity: 0.9"
        controller-ui>
      </a-entity>
      <a-entity id="rightHand" laser-controls="hand: right"
        raycaster="objects: .clickable, .teleportable; far: 30"
        line="opacity: 0.9"
        controller-ui>
      </a-entity>
    </a-entity>

    <!-- LIGHTS (if lights are missing you get black; keep these always-on) -->
    <a-entity light="type: ambient; intensity: 0.75"></a-entity>
    <a-entity light="type: directional; intensity: 1.0" position="2 5 3"></a-entity>
    <a-entity light="type: point; intensity: 0.8; distance: 16" position="-2 3 -2"></a-entity>

    <!-- WORLD -->
    <a-plane id="floor" class="teleportable"
      rotation="-90 0 0" width="40" height="40"
      material="color:#1a2430; roughness:1; metalness:0"></a-plane>

    <a-ring rotation="-90 0 0" radius-inner="4.2" radius-outer="6.4"
      material="color:#16202b; roughness:1; metalness:0; opacity:0.98"></a-ring>

    <a-ring id="tpRing" rotation="-90 0 0" radius-inner="0.18" radius-outer="0.24"
      material="color:#00d2ff; emissive:#00d2ff; emissiveIntensity:0.9; opacity:0.95"
      visible="false"></a-ring>

    <!-- Table placeholder (always present even if JS fails) -->
    <a-cylinder position="0 0.75 -2" radius="1.2" height="0.12"
      material="color:#7a0011; roughness:0.9; metalness:0.1"></a-cylinder>
    <a-cylinder position="0 0.38 -2" radius="0.18" height="0.76"
      material="color:#2b2b2b; roughness:1; metalness:0"></a-cylinder>

    <!-- Jumbotron (no video by default to avoid CORS/autoplay issues) -->
    <a-entity id="jumbotron" position="0 2.2 -6">
      <a-plane id="screen" width="5.2" height="2.9" radius="0.06"
        material="color:#0d141c; shader: flat"></a-plane>
      <a-plane width="5.4" height="3.1" position="0 0 -0.02"
        material="color:#000; opacity:0.65"></a-plane>

      <a-text id="screenText" value="JUMBOTRON READY"
        position="0 0 0.01" align="center" width="6.2" color="#dfefff"></a-text>

      <!-- Button panel under screen -->
      <a-entity id="buttonPanel" position="0 -2.15 0">
        <a-plane width="5.2" height="0.8" radius="0.06"
          material="color:#0e1620; opacity:0.92"></a-plane>

        <a-entity position="-1.65 0 0.02" ui-button="label: LOAD; action: load"></a-entity>
        <a-entity position="-0.55 0 0.02" ui-button="label: PLAY; action: play"></a-entity>
        <a-entity position="0.55 0 0.02" ui-button="label: PAUSE; action: pause"></a-entity>
        <a-entity position="1.65 0 0.02" ui-button="label: NEXT; action: next"></a-entity>
      </a-entity>
    </a-entity>

    <!-- In-world diag text (if DOM HUD hidden) -->
    <a-entity position="0 1.65 -1.2" rotation="-10 0 0">
      <a-plane width="1.35" height="0.6" material="color:#000; opacity:0.55"></a-plane>
      <a-text id="diagText3d" value="booting…" position="0 0 0.01" align="center" width="1.7" color="#b6f7ff"></a-text>
    </a-entity>

    <a-sky color="#050a10"></a-sky>

    <script src="js/boot.js"></script>
  </a-scene>
</body>
</html>
