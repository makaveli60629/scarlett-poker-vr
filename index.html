<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"/>
  <meta name="theme-color" content="#000000" />
  <title>ScarlettVR Poker</title>

  <style>
    html, body { margin:0; padding:0; width:100%; height:100%; background:#000; overflow:hidden; }
    #app { position:fixed; inset:0; }
    canvas { display:block; width:100%; height:100%; touch-action:none; }

    #hud{
      position:fixed; left:10px; top:10px; z-index:50;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:#fff; user-select:none; -webkit-user-select:none;
    }
    #hudRow{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .btn{
      background:rgba(0,0,0,0.55);
      border:1px solid rgba(255,255,255,0.25);
      color:#fff; padding:10px 12px; border-radius:10px; font-size:14px; cursor:pointer;
    }
    .btn:active{ transform:translateY(1px); }
    #status{
      margin-top:8px; padding:8px 10px; border-radius:10px;
      background:rgba(0,0,0,0.45); border:1px solid rgba(255,255,255,0.18);
      max-width:min(92vw, 640px); line-height:1.25; white-space:pre-wrap;
    }

    /* ✅ Ultimate diag: never traps you */
    #diagPanel{
      position:fixed; right:10px; top:10px; z-index:60;
      display:none;
      width:min(92vw, 420px);
      max-height:70vh;              /* ✅ key */
      overflow:auto;                 /* ✅ key */
      -webkit-overflow-scrolling:touch;
      background:rgba(0,0,0,0.72);
      border:1px solid rgba(255,0,0,0.55);
      border-radius:14px;
      padding:10px;
      box-shadow:0 8px 24px rgba(0,0,0,0.35);
    }
    #diagHeader{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      position:sticky; top:0;
      padding:4px 0 8px 0;
      background:rgba(0,0,0,0.72);
      backdrop-filter: blur(6px);
      z-index:2;
    }
    #diagTitle{ font-weight:800; color:#ff5b5b; }
    .btnRed{
      background:rgba(255,0,0,0.15);
      border:1px solid rgba(255,0,0,0.65);
      color:#fff; padding:9px 10px; border-radius:10px; font-size:13px; cursor:pointer;
    }
    .row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin:8px 0; }
    .chip{
      display:inline-block;
      padding:6px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(255,255,255,0.06);
      font-size:12px;
      opacity:0.95;
    }
    .section{
      margin-top:10px;
      border-top:1px solid rgba(255,255,255,0.12);
      padding-top:10px;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      white-space:pre-wrap;
      word-break:break-word;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(0,0,0,0.35);
      border-radius:10px;
      padding:8px;
    }
    .muted{ opacity:0.85; font-size:12px; line-height:1.25; }
  </style>
</head>

<body>
  <div id="app"></div>

  <div id="hud">
    <div id="hudRow">
      <button class="btn" id="btnEnterVr">Enter VR</button>
      <button class="btn" id="btnHideHud">Hide HUD</button>
      <button class="btn" id="btnTeleport">Teleport: OFF</button>
      <button class="btn" id="btnDiag">Diag</button>
    </div>
    <div id="status">booting…</div>
  </div>

  <div id="diagPanel">
    <div id="diagHeader">
      <div id="diagTitle">Scarlett Debug</div>
      <div class="row" style="margin:0;">
        <button class="btnRed" id="btnDiagClose">Close</button>
      </div>
    </div>

    <div class="row">
      <button class="btnRed" id="btnTestModules">Test Modules</button>
      <button class="btnRed" id="btnResetPlayer">Reset Player</button>
      <button class="btnRed" id="btnReload">Reload</button>
    </div>

    <div class="row">
      <button class="btnRed" id="btnCopyLogs">Copy Logs</button>
      <button class="btnRed" id="btnClearLogs">Clear Logs</button>
      <button class="btnRed" id="btnPanicClose">PANIC CLOSE</button>
    </div>

    <div class="section">
      <div class="muted"><b>Input Map</b>: Left Y = toggle diag • Right stick = move • Left stick = snap • Grip = teleport aim (when enabled)</div>
    </div>

    <div class="section">
      <div class="muted"><b>Controllers</b></div>
      <div id="diagControllers" class="mono">loading…</div>
    </div>

    <div class="section">
      <div class="muted"><b>Modules (runtime registry)</b></div>
      <div id="diagModules" class="mono">waiting for world…</div>
    </div>

    <div class="section">
      <div class="muted"><b>Recent logs</b></div>
      <div id="diagLogs" class="mono">…</div>
    </div>
  </div>

  <!-- IMPORTANT: keep your boot chain the way you already fixed it -->
  <script type="module" src="./js/boot.js"></script>
</body>
</html>
