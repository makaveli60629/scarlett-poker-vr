<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker VR 1.3.1 - Solid Logic</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.2/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-blink-controls/dist/aframe-blink-controls.min.js"></script>

    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
        /* Branded Loading Screen */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 99999;
        }
        #brand-logo { width: 180px; margin-bottom: 20px; filter: drop-shadow(0 0 10px #00d2ff); }
        #start-btn {
            padding: 15px 40px; font-size: 1.2rem; background: #00d2ff; border: none;
            border-radius: 5px; cursor: pointer; font-weight: bold; color: #000;
        }
        .loading-text { color: #555; font-family: monospace; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="loading-screen">
        <img id="brand-logo" src="https://i.imgur.com/S8WvO7s.png">
        <button id="start-btn" onclick="startApp()">DISMISS & PLAY</button>
        <p class="loading-text">INITIALIZING UPDATE 1.3.1 LOGIC...</p>
    </div>

    <a-scene id="poker-scene" renderer="antialias: true; colorManagement: true;" loading-screen="enabled: false">
        
        <a-assets timeout="10000">
            <img id="brick-tex" src="https://i.imgur.com/39A5P4S.jpg">
            <img id="logo-branding" src="https://i.imgur.com/S8WvO7s.png">
            
            <script id="hologram-shader" type="x-shader/x-fragment">
                varying vec2 vUv;
                uniform float time;
                void main() {
                    float pulse = 0.5 + 0.5 * sin(time * 3.0);
                    float scanline = sin(vUv.y * 100.0 + time * 5.0) * 0.1;
                    gl_FragColor = vec4(0.0, 0.8, 1.0, 0.6 + scanline) * pulse;
                }
            </script>
        </a-assets>

        <a-entity id="rig" position="0 0 5">
            <a-camera id="camera" look-controls>
                <a-cursor fuse="false" raycaster="objects: .clickable"></a-cursor>
            </a-camera>
            
            <a-entity id="leftHand" oculus-touch-controls="hand: left" 
                      blink-controls="cameraRig: #rig; teleportOrigin: #camera; collisionEntities: .nav-mesh; button: trigger">
            </a-entity>

            <a-entity id="rightHand" oculus-touch-controls="hand: right" 
                      laser-controls="hand: right" raycaster="objects: .clickable; far: 10">
            </a-entity>
        </a-entity>

        <a-plane class="nav-mesh" rotation="-90 0 0" width="100" height="100" visible="false"></a-plane>

        <a-entity id="lobby">
            <a-box position="0 2.5 -10" width="20" height="5" depth="0.5" src="#brick-tex" repeat="4 1"></a-box>
            <a-box position="10 2.5 0" rotation="0 -90 0" width="20" height="5" depth="0.5" src="#brick-tex"></a-box>
            <a-box position="-10 2.5 0" rotation="0 90 0" width="20" height="5" depth="0.5" src="#brick-tex"></a-box>
            
            <a-entity position="0 0 -5">
                <a-text value="DAILY GIVEAWAY" align="center" position="0 2.5 0" color="#00d2ff"></a-text>
                <a-cylinder class="clickable" radius="1" height="0.1" color="blue" onclick="claimDaily()">
                    <a-text id="daily-text" value="CLAIM" align="center" position="0 0.11 0" rotation="-90 0 0"></a-text>
                </a-cylinder>
            </a-entity>
        </a-entity>

        <a-entity id="zone-room" position="8 0 -8">
            <a-text value="TABLES ZONE" align="center" position="0 3 0" width="6"></a-text>
            <a-entity id="hologram-wallet" position="0 1.8 0">
                <a-text id="wallet-display" value="WALLET: $1000" align="center" color="#00FF00" 
                        animation="property: scale; to: 1.1 1.1 1.1; dir: alternate; dur: 1000; loop: true"></a-text>
                <a-light type="point" color="#00FF00" intensity="0.6" distance="3"></a-light>
            </a-entity>
        </a-entity>

        <a-entity id="poker-room-1" position="-12 0 -10">
            <a-box width="10" height="5" depth="0.5" position="0 2.5 -5" src="#brick-tex"></a-box>
            <a-entity class="clickable" onclick="sitAtTable()">
                <a-cylinder radius="2" height="0.2" color="#004d00">
                    <a-image src="#logo-branding" position="0 0.11 0" rotation="-90 0 0" width="1.5" height="1.5"></a-image>
                </a-cylinder>
                <a-text value="SIT DOWN" align="center" position="0 0.5 0"></a-text>
            </a-entity>
        </a-entity>

        <a-entity id="win-notification" position="0 2.5 -3" visible="false">
            <a-plane width="3" height="1.2" material="shader: flat; color: #00d2ff; opacity: 0.3; transparent: true">
                <a-text id="win-player" value="PLAYER 1 WINS" align="center" position="0 0.2 0.05" color="white"></a-text>
                <a-text id="win-hand" value="FULL HOUSE" align="center" position="0 -0.2 0.05" scale="0.8 0.8 0.8"></a-text>
            </a-plane>
            <a-ring color="#00d2ff" radius-inner="1.5" radius-outer="1.55" position="0 0 0"></a-ring>
        </a-entity>

        <a-entity environment="preset: starry; ground: canyon; grid: dots"></a-entity>
    </a-scene>

    <script>
        let wallet = 1000;

        // Ensure everything starts clean
        function startApp() {
            document.getElementById('loading-screen').style.display = 'none';
        }

        // Daily Pick Logic ($500 increments)
        function claimDaily() {
            const val = (Math.floor(Math.random() * 10) + 1) * 500;
            wallet += val;
            updateWallet();
            document.getElementById('daily-text').setAttribute('value', 'WON: $' + val);
        }

        function updateWallet() {
            document.getElementById('wallet-display').setAttribute('value', 'WALLET: $' + wallet);
        }

        // Auto-Sit Logic
        function sitAtTable() {
            const rig = document.getElementById('rig');
            rig.setAttribute('position', '-12 0 -9'); // Move player to seat
            // Simulate a win for testing
            setTimeout(() => {
                triggerWinUI("USER", "STRAIGHT FLUSH");
            }, 3000);
        }

        // 10-Second Hologram Win Notification
        function triggerWinUI(name, hand) {
            const ui = document.getElementById('win-notification');
            document.getElementById('win-player').setAttribute('value', name + " WINS POT!");
            document.getElementById('win-hand').setAttribute('value', "HAND: " + hand);
            
            ui.setAttribute('visible', 'true');
            // Flash effect can be added here
            setTimeout(() => {
                ui.setAttribute('visible', 'false');
            }, 10000); // 10 seconds exactly
        }
    </script>
</body>
</html>
