<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
  />
  <title>ScarlettVR Poker â€” Full 1.10</title>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- THREE safety -->
  <script>
    window.THREE = window.THREE || (window.AFRAME && AFRAME.THREE);
  </script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #0b1420;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
        sans-serif;
    }

    #hud {
      position: fixed;
      top: 12px;
      left: 12px;
      right: 12px;
      pointer-events: auto;
      z-index: 20;
    }

    .hudRow {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
    }

    .hudBtn {
      background: linear-gradient(180deg, #1b2a3f, #0f1a2a);
      color: #eaf2ff;
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 14px;
      padding: 10px 16px;
      font-size: 14px;
      cursor: pointer;
    }

    .hudBtn[aria-pressed="true"] {
      background: linear-gradient(180deg, #2f5fa3, #1b3f6f);
    }

    #diagPanel {
      display: none;
      margin-top: 8px;
      background: rgba(0,0,0,.72);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 14px;
      padding: 12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", monospace;
      font-size: 12px;
      line-height: 1.35;
      white-space: pre-wrap;
      max-height: 44vh;
      overflow: auto;
      color: #eaf2ff;
      text-shadow: 0 1px 1px rgba(0,0,0,.6);
    }
  </style>
</head>

<body>

<div id="hud">
  <div class="hudRow">
    <button id="btnEnterVR" class="hudBtn">Enter VR</button>
    <button id="btnTeleport" class="hudBtn" aria-pressed="true">Teleport: ON</button>
    <button id="btnReset" class="hudBtn">Reset to Spawn</button>
  </div>
  <div class="hudRow">
    <button id="btnHideHUD" class="hudBtn">Hide HUD</button>
    <button id="btnDiag" class="hudBtn">Diagnostics</button>
    <button id="btnDemo" class="hudBtn" aria-pressed="true">Demo: ON</button>
    <button id="btnJumbo" class="hudBtn">Jumbotron Buttons</button>
  </div>
  <div id="diagPanel"></div>
</div>

<a-scene
  id="scene"
  embedded
  background="color: #0b1420"
  renderer="
    antialias: true;
    alpha: false;
    physicallyCorrectLights: true;
    colorManagement: true;
    exposure: 1.6;
  "
  xr-mode-ui="enabled: false"
  webxr="optionalFeatures: local-floor, bounded-floor, hand-tracking"
>

  <a-entity id="rig" position="0 0 16" rotation="0 180 0">
    <a-entity
      id="camera"
      camera
      look-controls
      position="0 1.6 0" rotation="0 180 0"></a-entity>

    <a-entity
      id="gazeCursor"
      cursor="fuse: true; fuseTimeout: 800"
      raycaster="objects: .uiTarget, .teleportable"
      position="0 0 -1"
      geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
      material="color: #9fd4ff; shader: flat"
      visible="false"
    ></a-entity>
  </a-entity>

  <a-entity id="world"></a-entity>

  <!-- Bright light rig -->
  <a-entity id="lightRig">
    <a-entity light="type: ambient; intensity: 1.35; color: #ffffff"></a-entity>
    <a-entity light="type: hemisphere; intensity: 1.0; color: #eaf2ff; groundColor: #0a1018"></a-entity>

    <a-entity light="type: directional; intensity: 1.8" position="4 10 6"></a-entity>
    <a-entity light="type: directional; intensity: 1.2" position="-6 9 -4"></a-entity>

    <a-entity light="type: point; intensity: 1.4; distance: 45" position="10 6 10"></a-entity>
    <a-entity light="type: point; intensity: 1.4; distance: 45" position="-10 6 10"></a-entity>
    <a-entity light="type: point; intensity: 1.2; distance: 45" position="10 6 -10"></a-entity>
    <a-entity light="type: point; intensity: 1.2; distance: 45" position="-10 6 -10"></a-entity>
  </a-entity>

  <a-sky color="#101a28"></a-sky>

</a-scene>

<script id="avatarManifest" type="application/json">
[
  "assets/avatars/ninja.glb",
  "assets/avatars/male.glb",
  "assets/avatars/female.glb"
]
</script>

<!-- Modules -->
<script src="./js/boot.js"></script>
<script src="./js/world.js"></script>
<script src="./js/locomotion.js"></script>
<script src="./js/name_tag_focus.js"></script>
<script src="./js/avatar_loader.js"></script>
<script src="./js/poker_demo.js"></script>

<!-- FORCE BUILD FAILSAFE -->
<script>
(function(){
  function forceBuild(){
    if (window.SCARLETT_WORLD && typeof window.SCARLETT_WORLD.build === "function") {
      try { window.SCARLETT_WORLD.build(); } catch(e) {}
      return true;
    }
    return false;
  }

  if (forceBuild()) return;

  let tries = 0;
  const iv = setInterval(() => {
    tries++;
    if (forceBuild()) clearInterval(iv);
    if (tries > 120) clearInterval(iv);
  }, 50);
})();
</script>

</body>
</html>
