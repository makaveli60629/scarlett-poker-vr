<script>
  (function () {
    function show(msg) {
      let el = document.getElementById("fatal");
      if (!el) {
        el = document.createElement("pre");
        el.id = "fatal";
        el.style.position = "fixed";
        el.style.left = "10px";
        el.style.top = "10px";
        el.style.right = "10px";
        el.style.maxHeight = "55vh";
        el.style.overflow = "auto";
        el.style.padding = "12px";
        el.style.background = "rgba(120,0,0,0.85)";
        el.style.color = "#fff";
        el.style.zIndex = "999999";
        el.style.borderRadius = "12px";
        el.style.whiteSpace = "pre-wrap";
        document.body.appendChild(el);
      }
      el.textContent = msg;
    }

    window.addEventListener("error", (e) => {
      const where = `${e.filename || ""}:${e.lineno || ""}:${e.colno || ""}`;
      show(`❌ JS ERROR\n${e.message}\n${where}\n\n${(e.error && e.error.stack) ? e.error.stack : ""}`);
    });

    window.addEventListener("unhandledrejection", (e) => {
      show(`❌ PROMISE REJECTION\n${String(e.reason || e)}`);
    });
  })();
</script>
