<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker VR 1.3.2 - Master Build</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.2/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-blink-controls/dist/aframe-blink-controls.min.js"></script>

    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
        #loading-gate {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 10000; color: white; font-family: sans-serif;
        }
        .btn { padding: 20px 50px; font-size: 1.2rem; background: #00d2ff; border: none; cursor: pointer; font-weight: bold; border-radius: 10px; margin-top: 20px; }
    </style>
</head>
<body>

    <div id="loading-gate">
        <img src="assets/textures/brand_logo.jpg" style="width:220px" onerror="this.src='https://i.imgur.com/S8WvO7s.png'">
        <h1 style="letter-spacing: 4px;">POKER VR v1.3.2</h1>
        <button class="btn" onclick="this.parentElement.style.display='none'">ENTER VR</button>
    </div>

    <a-scene renderer="antialias: true; colorManagement: true;" loading-screen="enabled: false">
        
        <a-assets timeout="8000">
            <img id="brick-tex" src="assets/textures/brickwall.jpg">
            <img id="logo-tex" src="assets/textures/brand_logo.jpg">
            <img id="carpet-tex" src="assets/textures/lobby_carpet.jpg">
            <img id="casino-art" src="assets/textures/casino_art.jpg">
            <img id="daily-tex" src="assets/textures/dailyclaim.jpg">
            <img id="table-atlas" src="assets/textures/table_atlas.jpg">
        </a-assets>

        <a-entity environment="preset: starry; ground: canyon; skyType: atmosphere; skyColor: #000; stars: true"></a-entity>

        <a-entity id="rig" position="0 0 5">
            <a-camera id="camera" look-controls>
                <a-entity id="main-menu" position="0 0 -1.2" visible="false">
                    <a-plane width="1.2" height="0.9" color="#111" opacity="0.9">
                        <a-text value="MAIN MENU" align="center" position="0 0.35 0.01" color="#00d2ff" width="3"></a-text>
                        <a-box class="clickable" position="0 0.05 0.02" width="0.8" height="0.18" color="#ff4444" onclick="location.reload()">
                            <a-text value="EXIT GAME" align="center" scale="0.3 0.3 0.3" color="white"></a-text>
                        </a-box>
                        <a-box class="clickable" position="0 -0.25 0.02" width="0.8" height="0.18" color="#555" onclick="toggleMenu()">
                            <a-text value="RESUME (Y)" align="center" scale="0.3 0.3 0.3" color="white"></a-text>
                        </a-box>
                    </a-plane>
                </a-entity>
            </a-camera>

            <a-entity id="left-con" oculus-touch-controls="hand: left" 
                      blink-controls="cameraRig: #rig; teleportOrigin: #camera; collisionEntities: .nav-floor; button: trigger">
            </a-entity>

            <a-entity id="right-con" oculus-touch-controls="hand: right" laser-controls="hand: right" raycaster="objects: .clickable; far: 10"></a-entity>
        </a-entity>

        <a-plane class="nav-floor" rotation="-90 0 0" width="100" height="100" visible="false"></a-plane>

        <a-entity id="lobby">
            <a-plane position="0 0.01 0" rotation="-90 0 0" width="20" height="20" src="#carpet-tex" repeat="2 2"></a-plane>
            <a-box position="0 2.5 -10" width="20" height="5" depth="0.5" src="#brick-tex" repeat="4 1"></a-box>
            <a-box position="0 2.5 10" width="20" height="5" depth="0.5" src="#brick-tex" repeat="4 1"></a-box>
            <a-box position="10 2.5 0" rotation="0 90 0" width="20" height="5" depth="0.5" src="#brick-tex" repeat="4 1"></a-box>
            <a-box position="-10 2.5 0" rotation="0 90 0" width="20" height="5" depth="0.5" src="#brick-tex" repeat="4 1"></a-box>
            
            <a-plane src="#casino-art" position="0 2.5 -9.7" width="6" height="3.5"></a-plane>

            <a-entity position="0 0 -5">
                <a-text value="DAILY PICK" align="center" position="0 2.2 0" color="gold" width="5"></a-text>
                <a-cylinder class="clickable" radius="1.2" height="0.2" src="#daily-tex" onclick="dailyPick()"></a-cylinder>
            </a-entity>
        </a-entity>

        <a-entity id="store-room" position="20 0 20">
            <a-box position="0 2.5 -5" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            <a-box position="0 2.5 5" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            <a-box position="5 2.5 0" rotation="0 90 0" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            <a-box position="-5 2.5 0" rotation="0 90 0" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            
            <a-light type="point" color="#00FF00" position="0 3 0" intensity="2"></a-light>
            
            <a-entity position="0 1 0">
                <a-box class="clickable" width="1" height="1.2" depth="1" color="#222" onclick="buyChips()">
                    <a-sphere radius="0.2" position="0 0.4 0.6" color="gold"></a-sphere>
                    <a-text value="CHIP STORE\nBUY $5000" align="center" position="0 0.8 0" scale="0.6 0.6 0.6"></a-text>
                </a-box>
            </a-entity>
        </a-entity>

        <a-entity id="scorpion-room" position="-20 0 -20">
            <a-box position="0 2.5 -5" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            <a-box position="0 2.5 5" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            <a-box position="5 2.5 0" rotation="0 90 0" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            <a-box position="-5 2.5 0" rotation="0 90 0" width="10" height="5" depth="0.5" src="#brick-tex"></a-box>
            
            <a-entity position="0 0.8 0" class="clickable" onclick="autoSit()">
                <a-cylinder radius="2" height="0.1" src="#table-atlas" repeat="0.33 1" offset="0 0">
                    <a-image src="#logo-tex" position="0 0.06 0" rotation="-90 0 0" width="1.2" height="1.2"></a-image>
                </a-cylinder>
                <a-text value="PLAY SCORPION" align="center" position="0 1.5 0" width="5"></a-text>
            </a-entity>
        </a-entity>

        <a-entity position="8 0 -5">
            <a-text id="wallet-val" value="WALLET: $1000" align="center" color="#00FF00" scale="1.5 1.5 1.5"></a-text>
            <a-text value="TABLES ZONE" align="center" position="0 0.6 0" scale="0.8 0.8 0.8"></a-text>
        </a-entity>

        <a-entity id="win-display" position="0 2.5 -3" visible="false">
            <a-plane width="3" height="1.2" color="#00d2ff" opacity="0.5" transparent="true">
                <a-text id="win-name" value="WINNER" align="center" position="0 0.2 0.05"></a-text>
                <a-text id="win-hand" value="HAND" align="center" position="0 -0.2 0.05" scale="0.8 0.8 0.8"></a-text>
            </a-plane>
        </a-entity>

    </a-scene>

    <script>
        let walletBalance = 1000;
        let menuOpen = false;

        // Oculus Y-Button Handler
        document.querySelector('#left-con').addEventListener('ybuttondown', toggleMenu);

        function toggleMenu() {
            menuOpen = !menuOpen;
            document.getElementById('main-menu').setAttribute('visible', menuOpen);
        }

        function dailyPick() {
            const win = (Math.floor(Math.random() * 10) + 1) * 500;
            walletBalance += win;
            updateWallet();
        }

        function buyChips() {
            walletBalance += 5000;
            updateWallet();
        }

        function updateWallet() {
            document.getElementById('wallet-val').setAttribute('value', 'WALLET: $' + walletBalance);
        }

        function autoSit() {
            // Seating logic
            document.getElementById('rig').setAttribute('position', '-20 0 -19');
            
            // Winning Hand Popup (10 Seconds)
            const winUI = document.getElementById('win-display');
            document.getElementById('win-name').setAttribute('value', "USER WINS!");
            document.getElementById('win-hand').setAttribute('value', "FULL HOUSE");
            winUI.setAttribute('visible', 'true');
            
            setTimeout(() => {
                winUI.setAttribute('visible', 'false');
            }, 10000);
        }
    </script>
</body>
</html>
