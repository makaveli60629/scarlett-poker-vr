<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Scarlett Poker VR</title>

  <style>
    html, body { margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:#000; }
    #app { position:fixed; inset:0; }
    canvas { display:block; }

    /* HUD */
    #hud {
      position: fixed;
      left: 10px; top: 10px;
      width: min(520px, calc(100vw - 20px));
      max-height: 55vh;
      overflow: auto;
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.55);
      color: #e9eef7;
      font: 12px/1.35 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      z-index: 999999;
      backdrop-filter: blur(8px);
      user-select: text;
      pointer-events: auto;
    }
    #hud .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:8px; }
    #hud .pill {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
    }
    #hud pre { margin:0; white-space:pre-wrap; word-break:break-word; }
    #hud .btn {
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.06);
      color: #fff;
      cursor: pointer;
      font: 600 12px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    #hud .btn:active { transform: translateY(1px); }

    /* Always-visible HUD toggle button */
    #hudToggleBtn{
      position:fixed; right:12px; top:12px; z-index:999999;
      padding:10px 12px; border-radius:10px;
      background:rgba(0,0,0,.55); color:#fff; border:1px solid rgba(255,255,255,.25);
      font:600 14px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      backdrop-filter: blur(6px);
    }
    #hudToggleBtn:active{ transform: translateY(1px); }
  </style>
</head>

<body>
  <div id="app"></div>

  <!-- Diagnostics HUD -->
  <div id="hud">
    <div class="row">
      <span class="pill" id="boot-status">boot…</span>
      <button class="btn" id="copyLogBtn" type="button">Copy Log</button>
      <button class="btn" id="clearLogBtn" type="button">Clear</button>
      <button class="btn" id="enterVrBtn" type="button">Enter VR</button>
    </div>
    <pre id="hud-log">Loading…</pre>
  </div>

  <!-- Always-visible toggle -->
  <button id="hudToggleBtn" type="button" title="Toggle HUD (H)">HUD</button>

  <script>
    // HTML-side log hooks (boot.js + index.js use these safely)
    (() => {
      const logEl = document.getElementById("hud-log");
      const statusEl = document.getElementById("boot-status");
      const buf = [];

      window.__HTML_LOG = (line) => {
        buf.push(line);
        if (buf.length > 120) buf.splice(0, buf.length - 120);
        if (logEl) logEl.textContent = buf.join("\n");
      };

      window.__SET_BOOT_STATUS = (t) => {
        if (statusEl) statusEl.textContent = t;
      };

      // buttons
      const copyBtn = document.getElementById("copyLogBtn");
      const clearBtn = document.getElementById("clearLogBtn");

      copyBtn?.addEventListener("click", async () => {
        try {
          const text = logEl?.textContent || "";
          await navigator.clipboard.writeText(text);
          window.__SET_BOOT_STATUS("log copied ✅");
          setTimeout(() => window.__SET_BOOT_STATUS("ready"), 900);
        } catch (e) {
          window.__HTML_LOG(`[HTML] Copy failed: ${e?.message || String(e)}`);
        }
      });

      clearBtn?.addEventListener("click", () => {
        buf.length = 0;
        if (logEl) logEl.textContent = "";
        window.__SET_BOOT_STATUS("cleared");
        setTimeout(() => window.__SET_BOOT_STATUS("ready"), 500);
      });

      // HUD toggle (H key + button)
      const hud = document.getElementById("hud");
      const toggleBtn = document.getElementById("hudToggleBtn");
      let hidden = false;

      const apply = () => {
        if (hud) hud.style.display = hidden ? "none" : "block";
        if (toggleBtn) toggleBtn.textContent = hidden ? "HUD (off)" : "HUD";
      };

      const toggle = () => { hidden = !hidden; apply(); };

      toggleBtn?.addEventListener("click", toggle);
      window.addEventListener("keydown", (e) => {
        if (e.key === "h" || e.key === "H") toggle();
      });

      window.addEventListener("load", () => {
        apply();
        setTimeout(apply, 250);
        setTimeout(apply, 1000);
      });
    })();
  </script>

  <!-- ONLY entry point -->
  <script type="module" src="./js/boot.js"></script>
</body>
</html>
