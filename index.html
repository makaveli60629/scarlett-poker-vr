<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Poker VR 1.3 - FIXED ENGINE</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: sans-serif; }
        #overlay {
            position: fixed; top: 20px; left: 20px; color: #00f2ff;
            font-size: 20px; pointer-events: none; z-index: 10;
        }
    </style>
</head>
<body>
    <div id="overlay">WALLET: $5,000 | 4M CEILING ACTIVE</div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { VRButton } from 'three/addons/webxr/VRButton.js';

        // --- 1. ENGINE & VR BUTTON ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x050505);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        camera.position.set(0, 1.6, 4); // Start in middle of room

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.xr.enabled = true;
        document.body.appendChild(renderer.domElement);
        
        // THIS ADDS THE "ENTER VR" BUTTON TO YOUR BROWSER
        document.body.appendChild(VRButton.createButton(renderer));

        // --- 2. LIGHTING (Ensures no black screen) ---
        const amb = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(amb);
        const point = new THREE.PointLight(0xffffff, 1);
        point.position.set(0, 3.8, 0);
        scene.add(point);

        // --- 3. LUXURY DESIGN (4M CEILING & BRICK) ---
        const wallMat = new THREE.MeshStandardMaterial({ color: 0x4d1a1a }); // Brick
        const goldMat = new THREE.MeshStandardMaterial({ color: 0xffd700, metalness: 0.8 });

        // Floor and Ceiling (4 Meters Apart)
        const floor = new THREE.Mesh(new THREE.PlaneGeometry(20, 20), new THREE.MeshStandardMaterial({color: 0x111111}));
        floor.rotation.x = -Math.PI/2;
        scene.add(floor);

        const ceil = new THREE.Mesh(new THREE.PlaneGeometry(20, 20), new THREE.MeshStandardMaterial({color: 0x222222}));
        ceil.position.y = 4; // 4m Logic
        ceil.rotation.x = Math.PI/2;
        scene.add(ceil);

        // Brick Walls
        const backWall = new THREE.Mesh(new THREE.BoxGeometry(20, 4, 0.5), wallMat);
        backWall.position.set(0, 2, -10);
        scene.add(backWall);

        // Gold Pillars (Stops it from looking boring)
        const p1 = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.2, 4), goldMat);
        p1.position.set(-5, 2, -9);
        scene.add(p1);
        const p2 = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.2, 4), goldMat);
        p2.position.set(5, 2, -9);
        scene.add(p2);

        // --- 4. AVATAR MIRROR & LONG HAIR ---
        const mirror = new THREE.Mesh(new THREE.PlaneGeometry(3, 2.5), new THREE.MeshStandardMaterial({color: 0xaaaaaa, metalness: 1}));
        mirror.position.set(-9.7, 2, 0);
        mirror.rotation.y = Math.PI/2;
        scene.add(mirror);

        // Long Hair Representation
        const hair = new THREE.Mesh(new THREE.CapsuleGeometry(0.15, 0.6), new THREE.MeshStandardMaterial({color: 0x2b1d0e}));
        hair.position.set(-9.3, 1.8, 0); 
        scene.add(hair);

        // --- 5. OCULUS CONTROLS (RIGHT TRIGGER = OK) ---
        const controller = renderer.xr.getController(0);
        scene.add(controller);

        controller.addEventListener('selectstart', () => {
            console.log("OK Button Pressed!");
            // Auto-Sit Logic
            if(camera.position.z < 0) {
                camera.position.set(0, 1.1, -5);
                document.getElementById('overlay').innerText = "SITTING AT TABLE...";
            }
        });

        // --- 6. RENDER LOOP ---
        renderer.setAnimationLoop(() => {
            renderer.render(scene, camera);
        });

    </script>
</body>
</html>
