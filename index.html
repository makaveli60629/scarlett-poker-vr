<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Scarlett VR Poker</title>
  <style>
    html,body { margin:0; padding:0; overflow:hidden; background:#000; }
    #hud{
      position:fixed; left:12px; top:12px; right:12px;
      color:#fff; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:rgba(0,0,0,.55); border-radius:18px; padding:14px 16px;
      z-index:9999; backdrop-filter:blur(6px);
    }
    #hud .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;}
    .btn{
      padding:12px 16px; border-radius:14px; cursor:pointer;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.55); color:#fff; font-size:16px;
    }
    #log{
      position:fixed; left:12px; right:12px; bottom:84px;
      color:#9ff; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
      background:rgba(0,0,0,.55); border-radius:18px; padding:12px;
      max-height:40vh; overflow:auto; white-space:pre-wrap;
      z-index:9999; display:block; backdrop-filter:blur(6px);
    }
    #VRButton{ z-index:2147483647 !important; }
  </style>
</head>
<body>
  <div id="hud">
    <div style="font-size:34px;font-weight:800;margin-bottom:6px;">Scarlett VR Poker</div>
    <div>Quest: tap <b>ENTER VR</b> (bottom-right).</div>
    <div>Move: Left stick • Snap turn: Right stick • Teleport: Right trigger</div>
    <div style="opacity:.8;margin-top:6px">Android preview: WebXR may not exist — you’ll still see the world in 2D.</div>

    <div class="row">
      <button class="btn" id="recenterBtn">Recenter</button>
      <button class="btn" id="toggleLogBtn">Toggle Log</button>
      <button class="btn" id="reloadBtn">Reload</button>
      <button class="btn" id="fullscreenBtn">Fullscreen</button>
      <button class="btn" id="copyLogBtn">Copy Log</button>
    </div>

    <div id="mini" style="margin-top:10px;opacity:.9;font-family:ui-monospace,Menlo,Consolas,monospace">
      Build: <span id="buildId">-</span><br/>
      UA: <span id="ua">-</span><br/>
      navigator.xr: <span id="xr">-</span><br/>
      immersive-vr: <span id="ivr">-</span>
    </div>
  </div>

  <div id="log">Booting…</div>

  <script type="module">
    const logEl = document.getElementById('log');
    const buildEl = document.getElementById('buildId');
    const uaEl = document.getElementById('ua');
    const xrEl = document.getElementById('xr');
    const ivrEl = document.getElementById('ivr');

    window.__hubLog = (m) => {
      logEl.textContent += "\\n" + m;
      logEl.scrollTop = logEl.scrollHeight;
      console.log(m);
    };

    const v = Date.now().toString();
    window.__BUILD_V = v;
    buildEl.textContent = v;
    uaEl.textContent = /Quest|Oculus/i.test(navigator.userAgent) ? "Quest" : "Other";

    xrEl.textContent = !!navigator.xr;
    if (navigator.xr?.isSessionSupported) {
      navigator.xr.isSessionSupported("immersive-vr")
        .then(s => ivrEl.textContent = s ? "supported ✅" : "nope ❌")
        .catch(()=> ivrEl.textContent = "error");
    } else ivrEl.textContent = "n/a";

    __hubLog("BOOT v=" + v);

    document.getElementById("recenterBtn").onclick = () => window.dispatchEvent(new Event("scarlett-recenter"));
    document.getElementById("toggleLogBtn").onclick = () => logEl.style.display = (logEl.style.display === "none" ? "block" : "none");
    document.getElementById("reloadBtn").onclick = () => location.reload();
    document.getElementById("fullscreenBtn").onclick = async () => {
      try {
        if (!document.fullscreenElement) await document.documentElement.requestFullscreen();
        else await document.exitFullscreen();
      } catch {}
    };
    document.getElementById("copyLogBtn").onclick = async () => {
      try { await navigator.clipboard.writeText(logEl.textContent); __hubLog("[hud] copied log ✅"); }
      catch { __hubLog("[hud] copy failed ❌"); }
    };

    import(`./js/main.js?v=${v}`)
      .catch(e => __hubLog("❌ main import failed: " + (e?.message || e)));
  </script>
</body>
</html>
