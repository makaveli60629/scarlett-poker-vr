<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker VR - v1.3 (Silent & Stable)</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
</head>
<body>
    <a-scene background="color: #111">
        
        <a-assets timeout="3000">
            <a-mixin id="brick-wall" geometry="primitive: box" material="color: #442222; roughness: 0.8;"></a-mixin>
            <a-mixin id="poker-table-top" geometry="primitive: cylinder; radius: 2; height: 0.1;" material="color: #004d00;"></a-mixin>
        </a-assets>

        <a-entity id="rig" position="0 0 5">
            <a-camera id="camera" look-controls wasd-controls>
                <a-cursor color="yellow" fuse="false"></a-cursor>
            </a-camera>
            <a-entity oculus-touch-controls="hand: left" raycaster="objects: .clickable; far: 10;"></a-entity>
            <a-entity oculus-touch-controls="hand: right" raycaster="objects: .clickable; far: 10;"></a-entity>
        </a-entity>

        <a-entity id="lobby">
            <a-box position="0 2 -5" width="10" height="4" depth="0.2" mixin="brick-wall"></a-box>
            <a-text value="LOBBY & STORE" align="center" position="0 3.5 -4.9" color="white"></a-text>

            <a-entity id="daily-pick-area" position="-3 0 -3">
                <a-text value="DAILY GIVEAWAY" align="center" position="0 1.8 0" color="cyan" width="3"></a-text>
                <a-entity mixin="poker-table-top"></a-entity>
                <a-cylinder id="blue-chip" class="clickable" position="0 0.8 0" radius="0.15" height="0.05" color="blue"
                            animation="property: rotation; to: 0 360 0; loop: true; dur: 4000"
                            onclick="claimDaily()"></a-cylinder>
            </a-entity>
        </a-entity>

        <a-entity id="zone-area" position="12 0 0">
            <a-text value="TABLES ZONE ROOM" align="center" position="0 4 -3" color="#00ffff" width="8"></a-text>
            
            <a-entity id="hologram-display" position="0 2.2 -2">
                <a-plane material="color: #00ffff; opacity: 0.2; transparent: true" width="1.2" height="0.6"></a-plane>
                <a-text id="wallet-text" value="BALANCE: $2500" align="center" color="white" width="4"></a-text>
                <a-light type="point" color="#00ffff" intensity="0.8" distance="3"></a-light>
            </a-entity>

            <a-box id="back-door" class="clickable" position="0 1.5 -4" width="2.5" height="3" depth="0.2" color="#333"
                   animation__open="property: position; to: 3 1.5 -4; startEvents: click; dur: 1200">
                <a-text value="OPEN" align="center" position="0 0 0.15" color="yellow"></a-text>
            </a-box>
        </a-entity>

        <a-entity id="poker-room" position="25 0 0">
            <a-box position="0 2 -6" width="12" height="5" depth="0.2" mixin="brick-wall"></a-box>
            
            <a-entity id="main-table" position="0 0 -2">
                <a-entity mixin="poker-table-top"></a-entity>
                <a-text value="BRANDED POKER" align="center" position="0 0.06 0" rotation="-90 0 0" color="#FFD700" width="5"></a-text>
                
                <a-entity id="win-popup" visible="false" position="0 2.5 0">
                    <a-text id="win-msg" value="WINNER!" align="center" color="yellow" width="12" wrap-count="15"></a-text>
                    <a-light type="spot" color="gold" intensity="1"></a-light>
                </a-entity>
            </a-entity>

            <a-box id="sit-trigger" class="clickable" position="0 0.6 0.5" scale="0.6 0.2 0.6" color="green"
                   onclick="autoSit()">
                <a-text value="PLAY GAME" align="center" position="0 0.6 0" color="white"></a-text>
            </a-box>
        </a-entity>

    </a-scene>

    <script>
        let balance = 2500;

        // Logic for Daily Giveaway
        function claimDaily() {
            let amount = Math.floor(Math.random() * (5000 - 500 + 1)) + 500;
            balance += amount;
            document.querySelector('#wallet-text').setAttribute('value', 'BALANCE: $' + balance);
            alert("Claimed Daily: $" + amount + " (Check Wallet)");
        }

        // Logic for Auto-Sitting
        function autoSit() {
            const rig = document.querySelector('#rig');
            // Move player to the seat position at the table
            rig.setAttribute('position', '25 0 -0.5');
            console.log("Player seated. Game logic initialized.");
            
            // Mock-up of a winning hand trigger
            setTimeout(() => {
                triggerWin("YOU", 1200);
            }, 5000);
        }

        // Win Display Logic (10 seconds)
        function triggerWin(player, pot) {
            const winEl = document.querySelector('#win-popup');
            const winMsg = document.querySelector('#win-msg');
            
            winMsg.setAttribute('value', player + " WON THE POT \n $" + pot);
            winEl.setAttribute('visible', 'true');
            
            // Highlight player logic could be added here
            
            setTimeout(() => {
                winEl.setAttribute('visible', 'false');
            }, 10000); // 10 second display
        }

        // Ensure scene loads correctly
        window.onload = () => {
            console.log("Scene initialized. Music disabled for stability.");
        };
    </script>
</body>
</html>
