<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>High-Stakes VR Poker - Version 1.4 Audit Build</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.2/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.0.0/dist/aframe-extras.min.js"></script>
    <script>
        AFRAME.registerComponent('poker-logic', {
            init: function () {
                console.log("Poker Logic Initialized");
                this.setupMenuBinding();
            },
            setupMenuBinding: function() {
                const leftHand = document.querySelector('#leftHand');
                const menu = document.querySelector('#wristMenu');
                
                leftHand.addEventListener('abuttondown', () => {
                    menu.setAttribute('visible', !menu.getAttribute('visible'));
                });
            }
        });

        // Teleportation Laser Logic
        AFRAME.registerComponent('teleport-controls-custom', {
            init: function () {
                this.el.addEventListener('teleport-start', () => { /* Handle visual feedback */ });
            }
        });
    </script>
</head>
<body>
    <a-scene poker-logic renderer="antialias: true; colorManagement: true; exposure: 1.2;" shadow="type: pcfsoft">
        
        <a-assets>
            <img id="brickWall" src="assets/textures/brick_wall.jpg">
            <img id="carpetTex" src="assets/textures/carpet.jpg">
            <img id="leatherTex" src="assets/textures/leather_trim.jpg">
            <canvas id="pokerFeltCanvas"></canvas>
        </a-assets>

        <a-entity id="rig" movement-controls="fly: false; speed: 0.3" position="0 0 5">
            <a-entity camera position="0 1.6 0" look-controls></a-entity>
            
            <a-entity id="leftHand" 
                      hand-tracking-controls="hand: left;"
                      hand-controls="hand: left; handModelStyle: highPoly; color: #ffcccc">
                <a-entity id="wristWatch" position="0 0.05 0.1" rotation="-90 0 0">
                    <a-cylinder radius="0.03" height="0.01" color="#333"></a-cylinder>
                    <a-text value="12:00" position="-0.02 0.01 0" scale="0.1 0.1 0.1" color="cyan"></a-text>
                    <a-entity id="wristMenu" visible="false" position="0 0.1 0">
                        <a-plane width="0.2" height="0.3" color="#222" opacity="0.9">
                            <a-text value="MENU\n- Lobby\n- Store\n- Quit" align="center" scale="0.2 0.2 0.2" position="0 0 0.01"></a-text>
                        </a-plane>
                    </a-entity>
                </a-entity>
                <a-entity laser-controls="hand: left" raycaster="objects: .teleport-surface; far: 10; showLine: true"></a-entity>
            </a-entity>

            <a-entity id="rightHand" 
                      hand-tracking-controls="hand: right;"
                      hand-controls="hand: right; handModelStyle: highPoly; color: #ffcccc">
            </a-entity>
        </a-entity>

        <a-light type="ambient" intensity="0.4" color="#fff"></a-light>
        <a-light type="directional" position="1 5 1" intensity="0.8" castShadow="true"></a-light>
        <a-light type="point" position="0 3 0" intensity="0.5" color="#00ffff"></a-light>

        <a-entity id="pokerTable" position="0 0.9 0">
            <a-capsule radius="0.8" height="1.5" rotation="90 0 0" scale="1 1 0.1" material="color: #076324; roughness: 0.8;"></a-capsule>
            <a-capsule radius="0.85" height="1.55" rotation="90 0 0" scale="1 1 0.08" material="src: #leatherTex; color: #221100;" position="0 -0.02 0"></a-capsule>
            <a-cylinder radius="0.05" height="0.9" position="0.5 -0.45 0" color="#111"></a-cylinder>
            <a-cylinder radius="0.05" height="0.9" position="-0.5 -0.45 0" color="#111"></a-cylinder>
        </a-entity>

        <a-box id="floor" class="teleport-surface" static-body width="20" height="0.1" depth="20" material="src: #carpetTex; repeat: 10 10;"></a-box>
        
        <a-entity id="walls">
            <a-box position="0 2.5 -10" width="20" height="5" depth="0.2" material="src: #brickWall; repeat: 4 2;">
                <a-box position="-9.9 0 0.2" width="0.05" height="5" depth="0.05" material="emissive: #00ffff; emissiveIntensity: 2;"></a-box>
                <a-box position="9.9 0 0.2" width="0.05" height="5" depth="0.05" material="emissive: #00ffff; emissiveIntensity: 2;"></a-box>
            </a-box>
            <a-box position="-10 2.5 0" rotation="0 90 0" width="20" height="5" depth="0.2" material="src: #brickWall; repeat: 4 2;"></a-box>
            <a-box position="10 2.5 0" rotation="0 -90 0" width="20" height="5" depth="0.2" material="src: #brickWall; repeat: 4 2;"></a-box>
        </a-entity>

        <a-entity id="leaderboard" position="3 2 -4" rotation="0 -30 0">
            <a-plane width="2" height="1.5" color="#000" opacity="0.8">
                <a-text value="TOP PLAYERS" align="center" position="0 0.6 0.01" width="4"></a-text>
                <a-text value="1. User123 - $50,000\n2. AI_Dealer - $25,000\n3. Guest - $10,000" 
                        align="left" position="-0.8 0 0.01" width="3"></a-text>
            </a-plane>
        </a-entity>

    </a-scene>
</body>
</html>
