<!DOCTYPE html>
<html>
  <head>
    <title>Poker VR - Master Update 1.3</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
  </head>
  <body>
    <a-scene renderer="antialias: true; colorManagement: true;">
      <a-assets>
        <img id="brick-wall" src="assets/textures/brick_diffuse.jpg">
        <img id="table-felt" src="assets/textures/table_brand.jpg">
        <img id="brand-logo" src="logo.jpg">
        
        <a-mixin id="neon-blue" material="color: #00FFFF; emissive: #00FFFF; emissiveIntensity: 2; shader: flat"></a-mixin>
        <a-mixin id="checkpoint-disk" geometry="primitive: cylinder; radius: 0.6; height: 0.05" material="color: #39FF14; emissive: #39FF14; opacity: 0.8"></a-mixin>
        <a-mixin id="pillar" geometry="primitive: box; width: 0.6; height: 5; depth: 0.6" material="color: #111"></a-mixin>
      </a-assets>

      <a-light type="ambient" color="#FFF" intensity="1.2"></a-light>
      <a-light type="point" position="0 4 0" intensity="1" distance="50"></a-light>

      <a-entity id="rig" movement-controls="controls: checkpoint" checkpoint-controls="mode: animate" position="0 0 10">
        <a-camera id="camera" look-controls position="0 1.6 0">
            <a-cursor color="red" radius-inner="0.02" radius-outer="0.03"></a-cursor>
        </a-camera>
        <a-entity id="leftHand" hand-tracking-controls="hand: left; modelStyle: mesh;">
            <a-entity id="hand-menu" position="0.1 0.1 0" rotation="-90 0 0">
                <a-plane width="0.4" height="0.5" color="#111" opacity="0.9">
                    <a-text value="NAVIGATE" align="center" position="0 0.2 0.01" scale="0.15 0.15 0.15"></a-text>
                    <a-box id="btn-lobby" position="0 0.08 0.02" width="0.3" height="0.08" color="#444" class="collidable">
                        <a-text value="LOBBY" align="center" scale="0.1 0.1 0.1"></a-text>
                    </a-box>
                    <a-box id="btn-table" position="0 -0.02 0.02" width="0.3" height="0.08" color="#444" class="collidable">
                        <a-text value="POKER TABLE" align="center" scale="0.1 0.1 0.1"></a-text>
                    </a-box>
                    <a-box id="btn-store" position="0 -0.12 0.02" width="0.3" height="0.08" color="#444" class="collidable">
                        <a-text value="STORE" align="center" scale="0.1 0.1 0.1"></a-text>
                    </a-box>
                </a-plane>
            </a-entity>
        </a-entity>
        <a-entity id="rightHand" hand-tracking-controls="hand: right; modelStyle: mesh;"></a-entity>
      </a-entity>

      <a-entity id="world">
          <a-entity id="poker-room">
              <a-box position="0 2.5 -6" width="12" height="5" depth="0.2" material="src: #brick-wall; repeat: 4 2">
                  <a-plane src="#brand-logo" position="0 0 0.12" width="4" height="2" transparent="true"></a-plane>
              </a-box>
              <a-plane position="0 3.5 -2" width="3" height="1.5" color="#000" opacity="0.8">
                  <a-text value="CURRENT POT: $0\nSTAKES: 5/10" align="center" color="#00FFFF" scale="0.8 0.8 0.8"></a-text>
              </a-plane>
              <a-entity position="0 0.8 -2">
                  <a-cylinder radius="2" height="0.1" material="src: #table-felt"></a-cylinder>
                  <a-entity id="cp-table" mixin="checkpoint-disk" position="0 -0.79 1.5" play-game-logic></a-entity>
              </a-entity>
          </a-entity>

          <a-entity id="lobby-room" position="0 0 12">
              <a-text value="LOBBY" position="0 3 -3" align="center" scale="2 2 2"></a-text>
              <a-box id="daily-grab" position="-3 0.5 -2" width="1" height="1" depth="1" color="#FFD700">
                  <a-text value="DAILY GRAB\nCLICK ME" align="center" position="0 0.6 0" scale="0.5 0.5 0.5"></a-text>
              </a-box>
              <a-entity id="cp-lobby-spot" mixin="checkpoint-disk" position="0 0.01 -1"></a-entity>
          </a-entity>

          <a-entity id="store-room" position="-10 0 0" rotation="0 90 0">
              <a-text value="THE STORE" position="0 3 -3" align="center" scale="2 2 2"></a-text>
              <a-entity id="cp-store-spot" mixin="checkpoint-disk" position="0 0.01 -1"></a-entity>
          </a-entity>

          <a-entity id="decorations">
              <a-entity mixin="pillar" position="-5.9 2.5 -5.9"></a-entity>
              <a-entity mixin="pillar" position="5.9 2.5 -5.9"></a-entity>
              <a-entity mixin="pillar" position="-5.9 2.5 5.9"></a-entity>
              <a-entity mixin="pillar" position="5.9 2.5 5.9"></a-entity>
              <a-box mixin="neon-blue" position="0 0.1 -5.9" width="12" height="0.05" depth="0.05"></a-box>
              <a-box mixin="neon-blue" position="0 4.9 -5.9" width="12" height="0.05" depth="0.05"></a-box>
              <a-box mixin="neon-blue" position="-5.9 0.1 0" rotation="0 90 0" width="12" height="0.05" depth="0.05"></a-box>
          </a-entity>
      </a-entity>

      <a-entity id="winner-ui" position="0 2.5 -5.7" text="value: ; align: center; width: 6; color: #39FF14;"></a-entity>

    </a-scene>

    <script>
      // Component for Auto-Sit and Winning Hand Logic
      AFRAME.registerComponent('play-game-logic', {
        init: function () {
          this.el.addEventListener('navigation-start', () => {
            const rig = document.querySelector('#rig');
            rig.setAttribute('position', '0 0 -0.8'); // Move player to chair
            
            // Show winner for 10 seconds
            const winUI = document.querySelector('#winner-ui');
            winUI.setAttribute('text', 'value', 'YOU WON THE HAND!');
            setTimeout(() => { winUI.setAttribute('text', 'value', ''); }, 10000);
          });
        }
      });

      // Hand Menu Button Listeners
      document.querySelector('#btn-lobby').addEventListener('click', () => {
          document.querySelector('#rig').setAttribute('position', '0 0 10');
      });
      document.querySelector('#btn-table').addEventListener('click', () => {
          document.querySelector('#rig').setAttribute('position', '0 0 1');
      });
      document.querySelector('#btn-store').addEventListener('click', () => {
          document.querySelector('#rig').setAttribute('position', '-10 0 0');
      });

      // Daily Grab Logic
      document.querySelector('#daily-grab').addEventListener('click', () => {
          alert("Daily Chips Claimed!");
          document.querySelector('#daily-grab').setAttribute('color', '#444');
      });
    </script>
  </body>
</html>
